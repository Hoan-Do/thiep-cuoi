<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Hoàn & Huyền — Thiệp Cưới</title>

  <!-- Open Graph (Facebook, Zalo, iMessage...) -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Hoàn & Huyền — Thiệp Cưới">
  <meta property="og:title" content="Thiệp cưới Hoàn & Huyền">
  <meta property="og:description" content="Trân trọng kính mời bạn tới dự ngày vui của chúng tôi. Xem lịch, album và gửi lời chúc tại đây.">
  <meta property="og:url" content="https://hoan-do.github.io/thiep-cuoi/">
  <meta property="og:image" content="https://hoan-do.github.io/thiep-cuoi/image/og-wedding_1.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <!-- Twitter Card (nhiều app cũng đọc) -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Thiệp cưới Hoàn & Huyền">
  <meta name="twitter:description" content="Trân trọng kính mời bạn tới dự ngày vui của chúng tôi.">
  <meta name="twitter:image" content="https://hoan-do.github.io/thiep-cuoi/image/og-wedding_1.png">


  <!-- Fonts & Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800&family=Italiana&family=Quicksand:wght@400;600;700&family=Great+Vibes&family=Noto+Serif+SC:wght@900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            serif: ['Playfair Display','serif'],
            display: ['Italiana','serif'],
            sans: ['Quicksand','system-ui','sans-serif'],
            script: ['Great Vibes','cursive']
          },
          colors: {
            coffee:{50:'#f7f1ea',100:'#efe3d5',200:'#e6d5c3',300:'#dcc3a9',400:'#cfae90',500:'#b89473',600:'#8b5e3c',700:'#734a2b',800:'#5b3b22',900:'#45301d'},
            burg:'#7e1f24', gold:'#e1c285', rosey:'#d4a373'
          },
          backgroundImage:{
            hero:"url('image/hero_cover.png')",
            paperTex:"url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2248%22 height=%2248%22 viewBox=%220 0 48 48%22><filter id=%22n%22><feTurbulence type=%22fractalNoise%22 baseFrequency=%220.8%22 numOctaves=%222%22 stitchTiles=%22stitch%22/><feColorMatrix type=%22saturate%22 values=%220%22/><feComponentTransfer><feFuncA type=%22table%22 tableValues=%220 0 .04 .07%22/></feComponentTransfer></filter><rect width=%2248%22 height=%2248%22 filter=%22url(%23n)%22/></svg>')"
          },
          boxShadow:{frame:'0 10px 30px rgba(0,0,0,.08)', gentle:'0 8px 24px rgba(0,0,0,.06)'}
        }
      }
    }
  </script>

  <style>
    html,body{scroll-behavior:smooth}
    :root{ --sat: env(safe-area-inset-top, 0px); --sab: env(safe-area-inset-bottom, 0px); --vh: 1vh; }

    .section-card{background:linear-gradient(#fff,#fff) padding-box,linear-gradient(135deg,rgba(139,94,60,.18),rgba(212,163,115,.18)) border-box;border:1px solid transparent;border-radius:20px;box-shadow:0 12px 30px rgba(0,0,0,.06)}
    .divider{height:1px;background:linear-gradient(90deg,transparent,#e0d3c2,transparent)}
    .reveal{opacity:0;transform:translateY(14px);transition:opacity .6s ease,transform .6s ease}
    .reveal.show{opacity:1;transform:none}

    /* đảm bảo nội dung luôn nổi và hiển thị */
    #app{ position: relative; z-index: 1; opacity: 1 !important; filter: none !important; transform: none !important; display: block !important; }

    /* ========= COVER: màn đỏ tách đôi + seal 囍 ========= */
    :root{ --door-ms: 6s; }  /* chỉnh tốc độ mở tại đây */

	#cover{
	  position:fixed; inset:0; z-index:70; pointer-events:auto; background:transparent;
	  height:calc(var(--vh, 1vh) * 100);
	}
	@supports (height:100svh){ #cover{ height:100svh; } }
	@supports (height:100dvh){ #cover{ height:100dvh; } }

	/* Chia 2 nửa bằng GRID để luôn 50/50, không lệch vì scrollbar */
	#cover .doors{
	  position:absolute; inset:0;
	  display:grid; grid-template-columns:1fr 1fr;
	  contain:layout size paint;
	}
	.door{ position:relative; background:#7e1f24; will-change:transform; }
	/* Cánh trái vẫn ẩn phần tràn để không lộ mép */
	.doorL{ overflow:hidden; transform:translateX(0); transition:transform var(--door-ms) cubic-bezier(.19,1,.22,1); z-index:1; }
	/* Cánh phải cho tràn để seal không bị cắt */
	.doorR{ overflow:visible; transform:translateX(0); transition:transform var(--door-ms) cubic-bezier(.19,1,.22,1); z-index:2; }

	/* Mép giữa dưới seal (giữ nguyên) */
	.doorL::after, .doorR::before{ content:""; position:absolute; top:0; bottom:0; width:20px; pointer-events:none; z-index:5; }
	.doorL::after{ right:-1px; background:linear-gradient(90deg, rgba(0,0,0,.18), transparent); }
	.doorR::before{ left:-1px;  background:linear-gradient(270deg, rgba(0,0,0,.18), transparent); }

	/* Seal vẫn là con của .doorR và có z-index cao hơn */
	.seal{ z-index:20; /* các thuộc tính khác giữ nguyên */ }


	/* Mép giữa (seam) – dưới seal */
	.doorL::after, .doorR::before{
	  content:""; position:absolute; top:0; bottom:0; width:20px; pointer-events:none; z-index:5;
	}
	.doorL::after{ right:-1px; background:linear-gradient(90deg, rgba(0,0,0,.18), transparent); }
	.doorR::before{ left:-1px;  background:linear-gradient(270deg, rgba(0,0,0,.18), transparent); }

	/* Seal 囍 – CON của cánh phải, căn đúng tâm màn hình */
	.seal{
	  position:absolute; left:0;  /* mép trong cánh phải = trục giữa */
	  top:calc(50svh + (env(safe-area-inset-top,0px) - env(safe-area-inset-bottom,0px))/2);
	  transform:translate(-50%,-50%);
	  width:138px; height:138px; border-radius:999px;
	  background: radial-gradient(55% 55% at 30% 30%, #cc8b5a, #8a5630 70%);
	  box-shadow: inset 0 8px 18px rgba(255,255,255,.24),
				  inset 0 -8px 18px rgba(0,0,0,.28),
				  0 12px 26px rgba(0,0,0,.45);
	  display:grid; place-items:center; z-index:20; /* cao hơn seam & cánh */
	}
	@supports not (height:100svh){
	  .seal{ top:calc((var(--vh,1vh) * 50) + (env(safe-area-inset-top,0px) - env(safe-area-inset-bottom,0px))/2); }
	}
	.seal .xi{
	  font-family:'Noto Serif SC',serif; font-weight:900; font-size:90px;
	  background:linear-gradient(#f6d9a5,#c99f5f);
	  -webkit-background-clip:text; background-clip:text; color:transparent;
	  filter:drop-shadow(0 1px 1px rgba(0,0,0,.35)); user-select:none;
	}

	/* Mở màn */
	#cover.opened .doorL{ transform:translateX(-100%); }
	#cover.opened .doorR{ transform:translateX(100%);  }

	/* Gợi ý chạm */
	#cover .hint{
	  position:absolute; left:50%; bottom:calc(18px + env(safe-area-inset-bottom,0px)); transform:translateX(-50%);
	  color:#fff; background:rgba(0,0,0,.24); padding:.5rem .85rem; border-radius:12px; font-size:.9rem; letter-spacing:.06em; opacity:.95;
	  transition:opacity .3s ease;
	}
	#cover.opened .hint{ opacity:0; }


    /* ===== Bottom Action Bar (nếu bạn đang dùng) ===== */
    #actionbar{position:fixed;left:0;right:0;bottom:0;z-index:50;
      background:rgba(255,255,255,.92);-webkit-backdrop-filter:saturate(140%) blur(8px);backdrop-filter:saturate(140%) blur(8px);
      border-top:1px solid #e6d5c3; padding-bottom:calc(8px + var(--sab));
    }
    #actionbar a{flex:1 1 0; display:flex; flex-direction:column; align-items:center; gap:4px; padding:10px 6px 8px; color:#5b3b22}
    #actionbar a.active{color:#8b5e3c; font-weight:700}
    #actionbar svg{width:22px;height:22px;flex-shrink:0}
    body{padding-bottom:calc(64px + var(--sab));}

    /* Helpers */
    .no-scrollbar::-webkit-scrollbar{ display:none; } .no-scrollbar{ -ms-overflow-style:none; scrollbar-width:none; }
    .tappable{ touch-action: manipulation; } :focus-visible{ outline:3px solid #8b5e3c; outline-offset:2px; border-radius:10px; }

    @media (prefers-reduced-motion: reduce){
      #cover .doorL, #cover .doorR{ transition:none !important; }
    }


    /* Timeline slide-in */
    .timeline-item{
      opacity: 0;
      transform: translateX(var(--tx,0));
      transition: transform 8s cubic-bezier(.19,1,.22,1), opacity 8s ease;
      will-change: transform, opacity;
    }
    .timeline-item.from-left { --tx: -40px; }
    .timeline-item.from-right{ --tx:  40px; }
    .timeline-item.show      { opacity: 1; transform: translateX(0); }

    @media (prefers-reduced-motion: reduce){
      .timeline-item{ transition: none !important; transform: none !important; opacity: 1 !important; }
    }

  </style>
</head>



<body class="bg-coffee-50 bg-paperTex/30 text-coffee-900 font-sans antialiased">

  <!-- ========= COVER (chạm để mở) ========= -->
  <div id="cover" class="select-none">
	  <div class="doors">
		<div class="door doorL"></div>
		<div class="door doorR">
		  <!-- SEAL dính với cánh phải -->
		  <div class="seal" aria-label="Niêm phong"><span class="xi" aria-hidden="true">囍</span></div>
		</div>
	  </div>
	  <div class="hint">Chạm để mở thiệp</div>
	</div>

  <!-- ===== MUSIC TOGGLE ===== -->
  <button id="music-btn" class="fixed z-40 rounded-full bg-coffee-900 text-white w-12 h-12 grid place-items-center shadow-lg opacity-90 hover:opacity-100 tappable" style="right:1rem; bottom: calc(80px + var(--sab));" aria-label="Tắt/Bật tiếng">
    <svg id="icon-sound-on"  xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor"><path d="M3 10v4h4l5 5V5L7 10H3zM16.5 12a4.5 4.5 0 01-2.12 3.84l1.06 1.82A6.5 6.5 0 0018.5 12a6.5 6.5 0 00-3.06-5.66l-1.06 1.82A4.5 4.5 0 0116.5 12z"/></svg>
    <svg id="icon-sound-off" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 hidden" viewBox="0 0 24 24" fill="currentColor"><path d="M16.5 12a4.5 4.5 0 01-2.12 3.84l1.06 1.82A6.5 6.5 0 0018.5 12a6.5 6.5 0 00-3.06-5.66l-1.06 1.82A4.5 4.5 0 0116.5 12z"/><path d="M3 10v4h4l5 5V5L7 10H3zM19 8l-2 2m0 4l2 2"/></svg>
  </button>
  <audio id="bgm" preload="auto" playsinline></audio>

  <!-- ========= BOTTOM ACTION BAR (tuỳ chọn) ========= -->
  <nav id="actionbar" class="sm:hidden">
    <div class="max-w-6xl mx-auto flex">
      <a href="#home" class="ab-item" data-target="home" aria-label="Trang chủ">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="m12 3 9 7v11h-6v-6H9v6H3V10l9-7z"/></svg>
        <span class="text-[11px]">Trang chủ</span>
      </a>
      <a href="#timeline" class="ab-item" data-target="timeline" aria-label="Lịch trình">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 2h2v2h6V2h2v2h3a2 2 0 0 1 2 2v3H2V6a2 2 0 0 1 2-2h3V2zm15 8H2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V10zM6 14h5v5H6v-5z"/></svg>
        <span class="text-[11px]">Lịch</span>
      </a>
      <a href="#gallery" class="ab-item" data-target="gallery" aria-label="Album">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 19V7a2 2 0 0 0-2-2H5C3.9 5 3 5.9 3 7v12a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
        <span class="text-[11px]">Album</span>
      </a>
      <a href="#guestbook" class="ab-item" data-target="guestbook" aria-label="Lưu bút">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5zm13 0v4h4"/></svg>
        <span class="text-[11px]">Lưu bút</span>
      </a>
      <a href="#qr" class="ab-item" data-target="qr" aria-label="QR">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 3h8v8H3V3zm2 2v4h4V5H5zm6 6h10v10H11V11zm2 2v6h6v-6h-6zM3 13h6v2H3v-2zm0 4h4v2H3v-2zm10-8h2v2h-2V9zm4 0h4v2h-4V9z"/></svg>
        <span class="text-[11px]">QR</span>
      </a>
    </div>
  </nav>

  <!-- ========= MAIN CONTENT ========= -->
  <div id="app">
    <!-- ===== HERO ===== -->
    <section id="home" class="px-3 pt-3">
      <div class="relative overflow-hidden section-card shadow-gentle">
        <div class="absolute inset-0 bg-hero bg-cover bg-center will-change-transform" id="hero-bg"></div>
        <div class="absolute inset-0 bg-coffee-900/60"></div>
        <div class="relative z-10 text-center px-5 py-20">
          <p class="font-script text-3xl text-white/95 reveal">Thiệp Mời Cưới</p>
          <h1 class="font-display tracking-widest text-white text-4xl sm:text-6xl mt-2 reveal">ĐỖ HOÀN</h1>
          <p class="text-4xl font-script text-rosey -mt-2 reveal">&</p>
          <h2 class="font-display tracking-widest text-white text-3xl sm:text-5xl reveal">NGỌC HUYỀN</h2>
          <!--<p id="guest-line" class="mt-4 text-white/95 reveal">Trân trọng kính mời <span id="guest-name-display" class="font-semibold"></span></p> -->
          <div class="mt-6 inline-flex gap-2 reveal">
            <a href="#timeline" class="px-4 py-2 rounded-full bg-white/90 hover:bg-white text-coffee-900 font-semibold shadow-md tappable">Xem lịch</a>
            <a href="#guestbook" class="px-4 py-2 rounded-full border border-white/70 text-white/95 hover:bg-white/10 tappable">Gửi lời chúc</a>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== WRAPPER ===== -->
    <main class="max-w-6xl mx-auto px-3 pb-6 space-y-6 mt-4">

     <!-- Lịch trình -->
      <section id="timeline" class="scroll-mt-24">
        <div class="section-card p-5 sm:p-6 reveal">


          <!-- ==== INVITATION INFO BLOCK ==== -->
          <section class="invite-wrap">
            <div class="invite-card">
              <!-- Lời mời -->
              <p class="invite-heading">TRÂN TRỌNG KÍNH MỜI</p>
               <p id="invite-to" class="invite-heading"></p>
              <p class="invite-desc">
                TỚI THAM DỰ BUỔI TIỆC CƯỚI<br/>
                CÙNG GIA ĐÌNH CHÚNG TÔI VÀO LÚC
              </p>

              <!-- Thời gian -->
              <p class="invite-time">09 GIỜ 00 CHỦ NHẬT<br/>NGÀY 26 THÁNG 10 NĂM 2025</p>

              <!-- Địa điểm -->
               <!-- CR -->
              <p id="flg_cr" class="invite-place">TẠI TƯ GIA NHÀ TRAI</p>
              <p id="flg_cr1" class="invite-address">
                TDP Nguyễn, phường Vân Hà, tỉnh Bắc Ninh
              </p>
              <a id="flg_cr2" class="invite-map" href="https://maps.app.goo.gl/L6Ke3Ge2LyZaAHzt7" target="_blank">📍 Xem địa chỉ</a>

              <p id="flg_cd" class="invite-place">TẠI TƯ GIA NHÀ GÁI</p>
              <p id="flg_cd1" class="invite-address">
                TDP Đồng Ích, phường Tự Lạn, tỉnh Bắc Ninh
              </p>
              <a id="flg_cd2" class="invite-map" href="https://maps.app.goo.gl/HfXzVk7kmedeYhyw8" target="_blank">📍 Xem địa chỉ</a>

              <!-- Ghi chú -->
              <p id="invite-note" class="invite-note">
                Sự hiện diện của quý khách<br/>
                là niềm vinh hạnh cho gia đình chúng tôi
              </p>

              <!-- Hai cột -->
              <div class="invite-families">
                <div>
                  <p class="invite-col-title">NHÀ TRAI</p>
                  <p>ĐỖ VĂN THẬN<br/>NGUYỄN THỊ CHỨC</p>
                </div>
                <div>
                  <p class="invite-col-title">NHÀ GÁI</p>
                  <p>NGUYỄN ĐÌNH VÕ<br/>LÊ THỊ LƯƠNG</p>
                </div>
              </div>
            </div>
          </section>

          <style>
          .invite-wrap{display:flex;justify-content:center;padding:20px;}
          .invite-card{
            max-width:800px;width:100%;
            background:#f9f9f9; /* placeholder, tuỳ chỉnh */
            border-radius:12px; padding:8px; text-align:center;
          }
          .invite-heading{font-weight:bold;margin:0 0 10px;}
          .invite-desc{margin:0 0 16px;}
          .invite-time{font-weight:bold;margin:0 0 18px;}
          .invite-place{font-weight:bold;margin:0;}
          .invite-address{margin:6px 0 8px;}
          .invite-map{display:inline-block;margin-bottom:18px;text-decoration:none;}
          .invite-note{margin:0 0 18px;}
          .invite-families{display:flex;justify-content:space-between;gap:20px;}
          .invite-families > div{flex:1;}
          .invite-col-title{font-weight:bold;margin-bottom:4px;}
          </style>
          <!-- ==== /INVITATION INFO BLOCK ==== -->




          <h3 class="font-serif text-2xl font-bold text-coffee-700 text-center">Lịch trình ngày cưới</h3>


          <img src="image/Anh_nen_gep.jpg" loading="lazy" decoding="async" data-full="image/Anh_nen_gep.jpg" class="rounded-xl shadow-frame object-cover w-full h-800 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 1">


          <div class="timelinedetail">
          <div class="container left">
            <div class="content">
              <h2>9 GIỜ 00</h2>
              <p>Đón khách và đãi tiệc</p>
            </div>
          </div>
          <div class="container right">
            <div class="content">
              <h2>13 GIỜ 30</h2>
              <p><b>Lễ Vu Quy</b><br />
              Đc: TDP Đồng Ích, phường Tự Lạn, tỉnh Bắc Ninh</p>
            </div>
          </div>
          <div class="container left">
            <div class="content">
              <h2>15 GIỜ 00</h2>
              <p><b>Lễ Thành Hôn</b><br />
                Đc: TDP Nguyễn, phường Vân Hà, tỉnh Bắc Ninh
              </p>
            </div>
            </div>
          </div>
        </div>

        <style>
/* ===== Wedding timeline (scoped to .timelinedetail) ===== */

/* Khung tổng */
.timelinedetail{
  position:relative;
  max-width: 900px;
  margin: 10px auto 0;
  padding: 6px 10px 10px;
}

/* Đường kẻ dọc giữa (animate: moveline) */
.timelinedetail::after{
  content:"";
  position:absolute;
  top:0; bottom:0;
  left:50%;
  width:2px;
  background:#e6d5c3;                 /* nâu nhạt như viền thiệp */
  transform:translateX(-50%) scaleY(0);
  transform-origin: top;
  animation: moveline 1.2s ease-out forwards;
}

/* Mỗi mốc (giữ class .container/.left/.right như HTML sẵn có) */
.timelinedetail .container{
  position:relative;
  width:50%;
  padding: 10px 36px;                  /* thu gọn để tinh tế hơn */
  opacity:0;
  transform: translateY(16px);
  animation: movedown .6s ease-out forwards;
}

/* Trễ dần cho từng mốc (nếu có thêm mốc, cứ nối tiếp) */
.timelinedetail .container:nth-of-type(1){ animation-delay:.15s; }
.timelinedetail .container:nth-of-type(2){ animation-delay:.30s; }
.timelinedetail .container:nth-of-type(3){ animation-delay:.45s; }
.timelinedetail .container:nth-of-type(4){ animation-delay:.60s; }
.timelinedetail .container:nth-of-type(5){ animation-delay:.75s; }
.timelinedetail .container:nth-of-type(6){ animation-delay:.90s; }

/* Cột trái/phải */
.timelinedetail .left  { left:0;    text-align:left; }
.timelinedetail .right { left:50%;  text-align:left; } /* chữ vẫn trái cho đồng bộ thiệp */

/* Nội dung thẻ (card) */
.timelinedetail .content{
  background:#fff;
  border:1px solid #e6d5c3;
  border-radius:12px;
  padding:14px 16px;
  box-shadow:0 8px 24px rgba(0,0,0,.06);
}

.timelinedetail .content h2{
  margin:0 0 6px;
  font-weight:700;
  font-size:15px;
  color:#5b3b22;
  letter-spacing:.02em;
}
.timelinedetail .content p{
  margin:0;
  font-size:14px;
  color:#6f5f59;
  line-height:1.45;
}

/* Chấm tròn trên trục giữa */
.timelinedetail .container::after{
  content:"";
  position:absolute;
  top:18px;
  width:12px; height:12px;
  border-radius:999px;
  background:#fff;
  border:2px solid #e6d5c3;
  box-shadow:0 0 0 3px rgba(230,213,195,.35);
  z-index:2;
}
.timelinedetail .left::after  { right:-7px; }   /* bám về phía line giữa */
.timelinedetail .right::after { left:-7px;  }

/* Mũi tên nhỏ hướng vào card (tinh tế, mảnh) */
.timelinedetail .left::before,
.timelinedetail .right::before{
  content:"";
  position:absolute; top:20px;
  border:7px solid transparent;
}
.timelinedetail .left::before{
  right: 28px;
  border-left-color:#fff;
  filter: drop-shadow(-1px 0 0 #e6d5c3);
}
.timelinedetail .right::before{
  left: 28px;
  border-right-color:#fff;
  filter: drop-shadow(1px 0 0 #e6d5c3);
}

/* Responsive: về 1 cột, line sang trái */
@media (max-width: 700px){
  .timelinedetail{ padding-left:12px; padding-right:12px; }
  .timelinedetail::after{ left:22px; transform:translateX(-50%) scaleY(0); }
  .timelinedetail .container{ width:100%; left:0; padding-left:56px; padding-right:12px; }
  .timelinedetail .container::after{ left:16px; right:auto; }
  .timelinedetail .left::before,
  .timelinedetail .right::before{
    left:40px; right:auto;
    border:7px solid transparent;
    border-right-color:#fff;
    filter: drop-shadow(1px 0 0 #e6d5c3);
  }
}

/* ===== Animations ===== */
@keyframes movedown{
  from{ opacity:0; transform:translateY(16px); }
  to  { opacity:1; transform:none; }
}
@keyframes moveline{
  from{ transform:translateX(-50%) scaleY(0); }
  to  { transform:translateX(-50%) scaleY(1); }
}
</style>






        </div>
      </section>

      <!-- Countdown -->
      <section id="countdown" class="scroll-mt-24">
        <div class="section-card p-5 sm:p-6 reveal">
          <h3 class="font-serif text-2xl font-bold text-coffee-700 text-center">Đếm ngược tới ngày vui</h3>
          <div id="counter" class="mt-5 grid grid-cols-2 sm:grid-cols-4 gap-3 max-w-3xl mx-auto select-none">
            <div class="section-card py-4"><div id="days"  class="text-3xl font-serif font-bold text-center"></div><div class="text-xs mt-1 text-center">Ngày</div></div>
            <div class="section-card py-4"><div id="hours" class="text-3xl font-serif font-bold text-center"></div><div class="text-xs mt-1 text-center">Giờ</div></div>
            <div class="section-card py-4"><div id="mins"  class="text-3xl font-serif font-bold text-center"></div><div class="text-xs mt-1 text-center">Phút</div></div>
            <div class="section-card py-4"><div id="secs"  class="text-3xl font-serif font-bold text-center"></div><div class="text-xs mt-1 text-center">Giây</div></div>
          </div>
        </div>
      </section>

      <!-- Gallery -->
      <section id="gallery" class="scroll-mt-24">
        <div class="section-card p-5 sm:p-6 reveal">
          <h3 class="font-serif text-2xl font-bold text-coffee-700 text-center">Album ảnh cưới</h3>
          <div id="gallery-grid" class="mt-5 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 sm:gap-4">
            <img src="image/Anh_album_1_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_1_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 1">
            <img src="image/Anh_album_2_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_2_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 2">
            <img src="image/Anh_album_3_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_3_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 3">
            <img src="image/Anh_album_4_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_4_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 4">
            <img src="image/Anh_album_5_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_5_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 5">
            <img src="image/Anh_album_6_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_6_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 6">
            <img src="image/Anh_album_7_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_7_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 7">
            <img src="image/Anh_album_8_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_8_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 8">
            <img src="image/Anh_album_9_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_9_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 9">
            <img src="image/Anh_album_10_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_10_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 10">
            <img src="image/Anh_album_11_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_11_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 11">
            <img src="image/Anh_album_12_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_12_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 12">
            <img src="image/Anh_album_13_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_13_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 13">
            <img src="image/Anh_album_14_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_14_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 14">
            <img src="image/Anh_album_15_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_15_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 15">
            <img src="image/Anh_album_16_rz.jpg" loading="lazy" decoding="async" data-full="image/Anh_album_16_rz.jpg" class="rounded-xl shadow-frame object-cover w-full h-70 sm:h-56 md:h-72 cursor-zoom-in" alt="Ảnh cưới 16">   
                                
          </div>
        </div>
      </section>

      <!-- Guestbook -->
      <section id="guestbook" class="scroll-mt-24">
        <div class="grid md:grid-cols-2 gap-5 sm:gap-6">
          <div class="section-card p-5 sm:p-6 reveal">
            <h3 class="font-serif text-2xl font-bold text-coffee-700">Sổ lưu bút & lời chúc</h3>
            <form class="mt-4" onsubmit="event.preventDefault(); submitGuestbook();">
              <label class="text-sm">Tên của bạn</label>
              <input id="guest-name" class="mt-1 w-full rounded-lg border border-coffee-200 focus:outline-none focus:ring-2 focus:ring-rosey/60 p-2.5 text-[16px]" autocomplete="name" required />
              <label class="text-sm block mt-3">Lời chúc</label>
              <textarea id="guest-message" rows="4" class="mt-1 w-full rounded-lg border border-coffee-200 focus:outline-none focus:ring-2 focus:ring-rosey/60 p-2.5 text-[16px]" placeholder="Gửi vài lời yêu thương..." required></textarea>
              
              <!-- ⬇️ MỚI: lựa chọn tham dự -->
              <label class="text-sm block mt-3">Bạn có thể tham dự không?</label>
              <select id="guest-attend" class="mt-1 w-full rounded-lg border border-coffee-200 focus:outline-none focus:ring-2 focus:ring-rose/60 p-2.5 text-[16px] bg-white">
                <option value="yes">Sẽ tham dự</option>
                <option value="no">Xin phép không tham dự</option>
                <option value="maybe" selected>Chưa chắc / Sẽ phản hồi</option>
              </select>
              
              <button class="mt-3 w-full rounded-lg bg-coffee-600 hover:bg-coffee-700 text-white font-semibold py-2.5 tappable">Gửi lời chúc</button>
              <p id="form-status" class="text-sm mt-2" aria-live="polite"></p>
            </form>
            <p class="text-xs text-coffee-500 mt-4">User ID: <span id="user-id">N/A</span></p>
          </div>
          <div class="section-card p-0 overflow-hidden reveal">
            <div class="px-5 sm:px-6 pt-5 sm:pt-6">
              <h4 class="font-serif text-xl font-bold text-coffee-700">Lời chúc từ bạn bè</h4>
              <p class="text-sm text-coffee-700/80">Các lời chúc mới nhất sẽ hiện lên ngay tại đây 💌</p>
            </div>
            <div class="divider my-4"></div>
            <ul id="guestbook-list" class="px-5 sm:px-6 pb-5 sm:pb-6 max-h-[520px] overflow-auto"></ul>
          </div>
        </div>
      </section>

      <!-- QR -->
      <section id="qr" class="scroll-mt-24">
        <div id="qr_cd" class="section-card p-5 sm:p-6 reveal">
          <h3 class="font-serif text-2xl font-bold text-coffee-700 text-center">Mừng cưới cô dâu</h3>
            <img class="mx-auto block my-3 sm:my-4 w-50 h-70" alt="" loading="lazy" decoding="async"   
              src="image\QRTKNgocHuyen.jpg" />            
        </div>
        <div id="qr_cr" class="section-card p-5 sm:p-6 reveal">
          <h3 class="font-serif text-2xl font-bold text-coffee-700 text-center">Mừng cưới chú rể</h3>
            <img class="mx-auto block my-3 sm:my-4 w-50 h-70" alt="" loading="lazy" decoding="async"   
              src="image\QRTKVanHoan.jpg" />            
        </div>
      </section>
    </main>
  </div>

  <!-- Admin bar + login + panel -->
  <div id="admin-bar" class="hidden fixed top-0 left-0 right-0 bg-coffee-900 text-white text-sm px-3 py-2 flex items-center justify-between z-50">
    <span id="admin-info">Chế độ quản trị</span>
    <div class="flex items-center gap-2">
      <button id="btn-resend" class="text-xs bg-white/20 rounded px-2 py-1 hover:bg-white/30 tappable">Gửi lại email xác minh</button>
      <button id="btn-refresh" class="text-xs bg-white/20 rounded px-2 py-1 hover:bg-white/30 tappable">Tôi đã xác minh</button>
      <button id="btn-logout" class="text-xs bg-white/20 rounded px-2 py-1 hover:bg-white/30 tappable">Đăng xuất</button>
    </div>
  </div>

  <section id="admin-login-box" class="hidden max-w-2xl mx-auto px-4 py-10">
    <div class="section-card p-6">
      <h3 class="font-serif text-2xl font-bold text-coffee-700 text-center">Đăng nhập admin</h3>
      <form id="admin-login-form" class="max-w-md mx-auto mt-4">
        <label class="text-sm">Email</label>
        <input id="admin-email" type="email" class="mt-1 w-full rounded-lg border border-coffee-200 p-2.5 text-[16px]" placeholder="ban@domain.com" autocomplete="email" required />
        <label class="text-sm block mt-3">Mật khẩu</label>
        <input id="admin-password" type="password" class="mt-1 w-full rounded-lg border border-coffee-200 p-2.5 text-[16px]" placeholder="••••••••" autocomplete="current-password" required />
        <button class="mt-4 w-full rounded-lg bg-coffee-900 text-white font-semibold py-2.5 tappable">Đăng nhập</button>
        <p id="admin-login-msg" class="text-sm mt-2 text-center"></p>
      </form>
    </div>
  </section>

  <section id="admin-panel" class="hidden max-w-6xl mx-auto px-4 py-8">
    <div class="section-card p-6">
      <h3 class="font-serif text-2xl font-bold text-coffee-700 text-center">Trang quản lý lời chúc</h3>
      <p class="text-center text-sm text-coffee-700/80">Ẩn/hiện bất kỳ lời chúc nào (cần Rules cho phép cập nhật)</p>
      <ul id="pending-list" class="mt-6 grid gap-3"></ul>
    </div>
  </section>

  <footer class="bg-coffee-900 text-white text-center py-8 mt-10">
    <p>&copy; <span id="current-year"></span> Đỗ Hoàn & Ngọc Huyền. All rights reserved.</p>
  </footer>

  <!-- ========= SCRIPT 1: Cover & Music ========= -->
  <script type="module">
    const params = new URLSearchParams(location.search);

    // Music
    const DEFAULT_MUSIC="music/Shane_Filan_of_Westlife_-_Beautiful_In_White_Svadebnaya_2010_(mp3.pm).mp3";
    const FALLBACK_MUSIC="https://cdn.pixabay.com/download/audio/2022/04/05/audio_987b1b0d2d.mp3?filename=romantic-ambient-112996.mp3";
    const audio=document.getElementById('bgm');
    const musicParam=params.get('music');
	const cover = document.getElementById('cover');
	const doorR  = document.querySelector('#cover .doorR, #cover .right'); // tuỳ bạn dùng class nào
    audio.src=musicParam?decodeURIComponent(musicParam):DEFAULT_MUSIC;
    const icoOn=document.getElementById('icon-sound-on'); const icoOff=document.getElementById('icon-sound-off');
    document.getElementById('music-btn').addEventListener('click',async()=>{ setMuted(!audio.muted); if(audio.paused){ try{ await audio.play(); }catch{} } });
    audio.addEventListener('error',()=>{ try{ if(audio.currentSrc.indexOf('pixabay.com')===-1){ audio.src=FALLBACK_MUSIC; audio.play().catch(()=>{}); } }catch(e){} });

    // COVER open on tap (no auto open)
	// Cập nhật --vh như bạn đã có
	function setVH(){ const vh = window.innerHeight * 0.01; document.documentElement.style.setProperty('--vh', vh + 'px'); }
	setVH(); addEventListener('resize', setVH); addEventListener('orientationchange', setVH);

	function setMuted(m){
	  if(!audio) return;
	  audio.muted = m;
	  if(icoOn && icoOff){
		if(m){ icoOn.classList.add('hidden'); icoOff.classList.remove('hidden'); }
		else { icoOn.classList.remove('hidden'); icoOff.classList.add('hidden'); }
	  }
	  try{ localStorage.setItem('wedding-muted', m ? '1' : '0'); }catch{}
	}

	async function autoPlayOnce(){
	  if(!audio) return;
	  // Chỉ auto play 1 lần mỗi lần mở trang
	  if (sessionStorage.getItem('autoPlayed') === '1') return;
	  sessionStorage.setItem('autoPlayed', '1');

	  // đảm bảo có src & không mute
	  try{ if(!audio.src) audio.load(); }catch{}
	  setMuted(false);
	  audio.volume = 1;
	  try {
		// iOS an toàn hơn nếu reset currentTime ngay trước khi play
		if (audio.currentTime === 0) { try{ audio.currentTime = 0; }catch{} }
		await audio.play();
	  } catch(e) {
		// nếu file lỗi 404 hoặc bị chặn, bạn có thể gán fallback tại đây
		console.warn('Autoplay failed, will retry after transition', e);
	  }
	}

	const openCover = () => {
	  if (!cover || cover.classList.contains('opened')) return;
	  cover.classList.add('opened');
	  cover.style.pointerEvents = 'none';        // cho phép tương tác nội dung ngay
	  
	  // >>> phát nhạc NGAY trong thao tác chạm
	  autoPlayOnce();

	  const onEnd = (e) => {
		if (e.propertyName !== 'transform') return;
		try{ cover.remove(); }catch{ cover.style.display = 'none'; }
	  };
	  if (doorR) doorR.addEventListener('transitionend', onEnd, { once:true });
	};

	if (cover) cover.addEventListener('click', openCover, { passive:true });


	
  </script>

  <!-- ========= SCRIPT 2: App content (Firestore + countdown + gallery + bottom bar) ========= -->
  <script type="module">
    (async () => {
      try {
        const [{ initializeApp }, { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp, doc, updateDoc }] = await Promise.all([
          import("https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"),
          import("https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"),
        ]);

        const firebaseConfig = {
          apiKey: "AIzaSyBA4RTN8dLxXI2SPP6zTcUIWumb0mqYUgU",
          authDomain: "thiep-cuoi-c3d08.firebaseapp.com",
          projectId: "thiep-cuoi-c3d08",
          storageBucket: "thiep-cuoi-c3d08.firebasestorage.app",
          messagingSenderId: "221614290",
          appId: "1:221614290:web:a3db7a997326b19b3a9d0b",
          measurementId: "G-WECWPY5END"
        };
        const app = initializeApp(firebaseConfig);
        const db  = getFirestore(app);

        // Guest in hero
        const p = new URLSearchParams(location.search);
        const nameTo = p.get("to");
        const nameFrom = p.get("from");
        if (nameTo) { const el=document.getElementById('guest-name-display'); if(el) el.textContent=decodeURIComponent(nameTo); }
        else { const l=document.getElementById('guest-line'); if(l) l.classList.add('hidden'); }
        if (nameTo) { const el=document.getElementById('invite-to'); if(el) el.textContent=decodeURIComponent(nameTo); }
        else { const l=document.getElementById('guest-line'); if(l) l.classList.add('hidden'); }
        if(nameFrom === 'cr') {
          const els1 = document.getElementById("dynamic-section1_cd"); 
          const els2 = document.getElementById("dynamic-section2_cd");
          if(els1) els1.style.display = 'none';
          if(els2) els2.style.display = 'none';
          document.getElementById("qr_cd").style.display = 'none';
          document.getElementById("flg_cd").style.display = 'none';
          document.getElementById("flg_cd1").style.display = 'none';
          document.getElementById("flg_cd2").style.display = 'none';
        }else if (nameFrom === 'cd'){
          const els1 = document.getElementById("dynamic-section1_cr"); 
          const els2 = document.getElementById("dynamic-section2_cr");
          if(els1) els1.style.display = 'none';
          if(els2) els2.style.display = 'none';
          document.getElementById("qr_cr").style.display = 'none';
          document.getElementById("flg_cr").style.display = 'none';
          document.getElementById("flg_cr1").style.display = 'none';
          document.getElementById("flg_cr2").style.display = 'none';
          document.getElementById("invite-note").style.display = 'none';
        }

        // Submit guestbook
        window.submitGuestbook = async () => {
        const name = (document.getElementById('guest-name')?.value || '').trim();
        const message = (document.getElementById('guest-message')?.value || '').trim();
        const attend = (document.getElementById('guest-attend')?.value || 'maybe'); // ⬅️ lấy giá trị dropdown
        const status = document.getElementById('form-status');

        if (!name || !message) {
          if (status) { status.textContent = "Vui lòng nhập đầy đủ thông tin."; status.className = "text-red-600 mt-2"; }
          return;
        }
        try {
          await addDoc(collection(db, 'guestbook'), {
            name, message,
            attend,               // ⬅️ LƯU THÊM
            createdAt: serverTimestamp(),
            hidden: false
          });
          // reset form
          const nEl=document.getElementById('guest-name');
          const mEl=document.getElementById('guest-message');
          const aEl=document.getElementById('guest-attend');
          if(nEl) nEl.value = "";
          if(mEl) mEl.value = "";
          if(aEl) aEl.value = "maybe"; // về mặc định
          if (status) { status.textContent = "Đã gửi lời chúc thành công!"; status.className = "text-green-600 mt-2"; }
        } catch (e) {
          console.error(e);
          if (status) { status.textContent = "Gửi thất bại, vui lòng thử lại."; status.className = "text-red-600 mt-2"; }
        }
      };


        // Public render guestbook
        const qPublic=query(collection(db,'guestbook'),orderBy('createdAt','desc'));
        onSnapshot(qPublic,(snap)=>{
          const list=document.getElementById('guestbook-list'); if(!list) return; list.innerHTML="";
          snap.forEach(docSnap=>{
            const d=docSnap.data(); if(d.hidden===true) return;
            const li=document.createElement('li'); li.className="mb-3 p-4 rounded-xl border border-coffee-200 bg-white/80 shadow-sm";
            const when=d.createdAt?.toDate?d.createdAt.toDate().toLocaleString('vi-VN'):"";
            li.innerHTML=`<p class="font-semibold text-coffee-800">${d.name||''}</p>
                          <p class="text-coffee-700/90 mt-1">${d.message||''}</p>`
                          //<p class="text-xs text-coffee-600/70 mt-2 text-right">${when}</p>`
				;
            list.appendChild(li);
          });
        });

        // Admin (opt-in via ?admin=true)
        const isAdmin=p.get('admin')==='true';
        if(isAdmin){
          const { getAuth,onAuthStateChanged,signInWithEmailAndPassword,signOut,getIdToken,sendEmailVerification,reload } =
            await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js");
          const auth=getAuth(app);
          const loginBox=document.getElementById('admin-login-box');
          const adminBar=document.getElementById('admin-bar');
          const adminPanel=document.getElementById('admin-panel');
          const info=document.getElementById('admin-info');
          const uidPlace=document.getElementById('user-id');

          document.getElementById('admin-login-form')?.addEventListener('submit',async(e)=>{
            e.preventDefault();
            const email=document.getElementById('admin-email').value.trim();
            const pass=document.getElementById('admin-password').value;
            const msg=document.getElementById('admin-login-msg');
            msg.textContent="Đang đăng nhập...";
            try{ await signInWithEmailAndPassword(auth,email,pass); msg.textContent=""; }
            catch(err){ console.error(err); msg.textContent="Đăng nhập thất bại. Kiểm tra email/mật khẩu."; msg.className="text-red-600 mt-2 text-center"; }
          });
          document.getElementById('btn-logout')?.addEventListener('click',()=>signOut(auth));
          document.getElementById('btn-resend')?.addEventListener('click',async()=>{ if(!auth.currentUser) return; await sendEmailVerification(auth.currentUser); alert("Đã gửi email xác minh."); });
          document.getElementById('btn-refresh')?.addEventListener('click',async()=>{ if(!auth.currentUser) return; await reload(auth.currentUser); await getIdToken(auth.currentUser,true); updateUI(auth.currentUser); });

          function updateUI(user){
            if(user){ uidPlace.textContent=user.uid; adminBar.classList.remove('hidden'); loginBox.classList.add('hidden');
              info.textContent=`Đang đăng nhập: ${user.email||''} — Verified: ${user.emailVerified?'YES':'NO'}`;
              if(['hoandovan370@gmail.com'].includes(user.email||'')){ adminPanel.classList.remove('hidden'); bindAdminList(); }
              else adminPanel.classList.add('hidden');
            }else{ uidPlace.textContent='N/A'; adminBar.classList.add('hidden'); loginBox.classList.remove('hidden'); adminPanel.classList.add('hidden'); }
          }

          function bindAdminList(){
            const q=query(collection(db,'guestbook'),orderBy('createdAt','desc'));
            onSnapshot(q,(snap)=>{
              const list=document.getElementById('pending-list'); if(!list) return; list.innerHTML="";
              snap.forEach(docSnap=>{
                const d=docSnap.data(); const id=docSnap.id;
                const when=d.createdAt?.toDate?d.createdAt.toDate().toLocaleString('vi-VN'):"";
                const isHidden=d.hidden===true;
                const li=document.createElement('li');
                li.className="p-4 rounded-xl border bg-white flex items-start justify-between gap-4";
                li.innerHTML=`<div>
                                <p class="font-semibold ${isHidden?'line-through text-coffee-500/60':''}">${d.name||''}</p>
                                <p class="${isHidden?'line-through text-coffee-500/60':''}">${d.message||''}</p>
                                <p class="text-xs text-coffee-600/70 mt-1">${when}</p>
                              </div>
                              <button data-id="${id}" data-hide="${!isHidden}" class="px-3 py-1 rounded-md border ${isHidden?'bg-green-50 border-green-300 text-green-700':'bg-rose-50 border-rose-300 text-rose-700'} tappable">
                                ${isHidden?'Hiện':'Ẩn'}
                              </button>`;
                list.appendChild(li);
              });
            });
            document.getElementById('pending-list')?.addEventListener('click',async(e)=>{
              const btn=e.target.closest('button[data-id]'); if(!btn) return;
              const id=btn.getAttribute('data-id'); const hide=btn.getAttribute('data-hide')==='true';
              try{ if(auth.currentUser) await getIdToken(auth.currentUser,true); await updateDoc(doc(db,'guestbook',id),{hidden:!!hide}); }
              catch(err){ console.error(err); alert("Không thể cập nhật. Kiểm tra Rules & email admin."); }
            });
          }
          onAuthStateChanged(auth,updateUI);
        }

        // Countdown
        const target=new Date('2025-10-26T09:00:00+07:00').getTime();
        function tick(){
          const now=Date.now(), d=Math.max(0,target-now);
          const days=Math.floor(d/864e5), hours=Math.floor(d/36e5)%24, mins=Math.floor(d/6e4)%60, secs=Math.floor(d/1e3)%60;
          const $ = (id) => document.getElementById(id);
          $('days').textContent=days;
          $('hours').textContent=hours.toString().padStart(2,'0');
          $('mins').textContent=mins.toString().padStart(2,'0');
          $('secs').textContent=secs.toString().padStart(2,'0');
        }
        tick(); setInterval(tick,1000);

        document.getElementById('current-year').textContent=new Date().getFullYear();

        // Lightbox Album
        const grid=document.getElementById('gallery-grid');
        if(grid){
          const sources=Array.from(grid.querySelectorAll('img')).map(img=>img.getAttribute('data-full')||img.src);
          let idx=0,startX=0;
          const lb=document.createElement('div');
          lb.className='lb-backdrop';
          lb.innerHTML=`<style>
            .lb-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center;z-index:60}
            .lb-backdrop.active{display:flex}
            .lb-img{max-width:92vw;max-height:82vh;border-radius:18px;box-shadow:0 20px 60px rgba(0,0,0,.35)}
            .lb-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(255,255,255,.85);border-radius:999px;width:44px;height:44px;display:grid;place-items:center}
            .lb-prev{left:18px}.lb-next{right:18px}
            .lb-close{position:absolute;top:14px;right:14px;background:rgba(255,255,255,.9);width:40px;height:40px;border-radius:999px;display:grid;place-items:center}
          </style>
          <button class="lb-close" aria-label="Đóng">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#111" stroke-width="2"><path d="M18 6 6 18M6 6l12 12"/></svg>
            </button>
            <button class="lb-btn lb-prev" aria-label="Ảnh trước">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#111" stroke-width="2"><path d="m15 18-6-6 6-6"/></svg>
            </button>
            <img class="lb-img" alt="preview">
            <button class="lb-btn lb-next" aria-label="Ảnh sau">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#111" stroke-width="2"><path d="m9 6 6 6-6 6"/></svg>
            </button>`;
          document.body.appendChild(lb);
          const imgEl=lb.querySelector('.lb-img'); const prevB=lb.querySelector('.lb-prev'); const nextB=lb.querySelector('.lb-next'); const closeB=lb.querySelector('.lb-close');
          function show(i){ idx=(i+sources.length)%sources.length; imgEl.src=sources[idx]; lb.classList.add('active'); }
          function hide(){ lb.classList.remove('active'); imgEl.src=''; }
          grid.addEventListener('click',e=>{ const img=e.target.closest('img'); if(!img) return; const i=Array.from(grid.querySelectorAll('img')).indexOf(img); show(i); });
          prevB.addEventListener('click',()=>show(idx-1)); nextB.addEventListener('click',()=>show(idx+1)); closeB.addEventListener('click',hide);
          lb.addEventListener('click',e=>{ if(e.target===lb) hide(); });
          window.addEventListener('keydown',e=>{ if(!lb.classList.contains('active')) return; if(e.key==='Escape') hide(); if(e.key==='ArrowLeft') show(idx-1); if(e.key==='ArrowRight') show(idx+1); });
          imgEl.addEventListener('touchstart',e=>{ startX=e.touches[0].clientX; },{passive:true});
          imgEl.addEventListener('touchend',e=>{ const dx=e.changedTouches[0].clientX-startX; if(Math.abs(dx)>40) (dx>0?prevB:nextB).click(); });
        }

        // Bottom bar active state
        const items=[...document.querySelectorAll('#actionbar .ab-item')];
        const ids=['home','timeline','countdown','gallery','guestbook','qr'];
        const targets=ids.map(id=>document.getElementById(id)).filter(Boolean);
        const setActive=(id)=>items.forEach(a=>a.classList.toggle('active', a.dataset.target===id));
        const activeObs=new IntersectionObserver(entries=>{
          entries.forEach(ent=>{ if(ent.isIntersecting){ const id=ent.target.id; setTimeout(()=>setActive(id), 60);} });
        },{root:null, threshold:0.6, rootMargin:"-20% 0px -20% 0px"});
        targets.forEach(sec=>activeObs.observe(sec));

        // Reveal on scroll
        const revObs = new IntersectionObserver((entries) => {
          entries.forEach((ent) => {
            if (ent.isIntersecting) {
              ent.target.classList.add('show');
              revObs.unobserve(ent.target);
            }
          });
        }, { threshold: 0.2, rootMargin: "0px 0px -10% 0px" });
        document.querySelectorAll('.reveal').forEach(el => revObs.observe(el));
        if (!('IntersectionObserver' in window)) {
          document.querySelectorAll('.reveal').forEach(el => el.classList.add('show'));
        }

        // Slide-in cho timeline khi vào viewport
        const tlItems = document.querySelectorAll('#timeline .timeline-item');
        if (tlItems.length) {
          const slideObs = new IntersectionObserver((entries) => {
            entries.forEach((ent) => {
              if (ent.isIntersecting) {
                ent.target.classList.add('show');
                slideObs.unobserve(ent.target);
              }
            });
          }, { threshold: 0.25, rootMargin: "0px 0px -10% 0px" });
          tlItems.forEach(el => slideObs.observe(el));
        } else {
          // fallback nếu trình duyệt cũ
          document.querySelectorAll('#timeline .timeline-item').forEach(el => el.classList.add('show'));
        }


      } catch (err) {
        console.warn('[App init warning]', err);
      }
    })();
  </script>
</body>
</html>



